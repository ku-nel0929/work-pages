<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="google-site-verification" content="YdkYdalhqx1MHFQb7aFVKFsD7n2bUpgKDN--q0rWI9E" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LegalService",
      "name": "植村 土地家屋調査士・行政書士事務所",
      "image": "https://ku-nel0929.github.io/work-pages/sokkia-bg.png",
      "url": "https://ku-nel0929.github.io/work-pages/",
      "telephone": "080-7231-9467",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "花城町12番6号",
        "addressLocality": "花巻市",
        "addressRegion": "岩手県",
        "postalCode": "025-0075",
        "addressCountry": "JP"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": 39.3905,
        "longitude": 141.1186
      },
      "openingHoursSpecification": {
        "@type": "OpeningHoursSpecification",
        "dayOfWeek": [
          "Monday",
          "Tuesday",
          "Wednesday",
          "Thursday",
          "Friday"
        ],
        "opens": "09:00",
        "closes": "18:00"
      },
      "priceRange": "相談無料",
      "description": "岩手県花巻市の農地転用許可申請、土地の測量・分筆登記、相続手続きなら植村事務所へ。SIMAデータ読込による位置特定や、登録免許税計算などの便利ツールも無料公開中。"
    }
    </script>

    <title>位置図作成・SIMA読込・農地転用 | 植村 土地家屋調査士・行政書士事務所</title>
    <meta name="description" content="岩手県花巻市で農地転用許可申請、土地の測量、分筆登記をお考えなら当事務所へ。SIMAファイルを読み込んで位置図を作成するツールや、登録免許税計算ツールなどを無料公開中。">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- CSS設定 --- */
        :root {
            --primary-color: #0f2350; /* ネイビー */
            --survey-color: #c5a059;  /* ゴールド */
            --admin-color: #3b6c9b;   /* 青 */
            --text-color: #333;
            --white: #ffffff;
            --bg-body: #f0f0f0;
            --bg-form: #f9fbfd;
        }
        
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            line-height: 1.6;
            background-color: var(--bg-body);
        }

        a { text-decoration: none; color: inherit; }
        img { max-width: 100%; height: auto; }
        
        /* --- ヘッダー --- */
        header {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 15px 0;
            text-align: center;
            max-width: 1000px;
            margin: 0 auto; 
        }
        .logo { font-size: 1.4rem; font-weight: bold; }

        /* --- メインビジュアル --- */
        .hero {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            background-color: #87CEEB;
            background-image: url('sokkia-bg.png');
            background-size: cover;
            background-position: center;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--white);
            text-shadow: 0 2px 8px rgba(0,0,0,0.7);
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.3);
        }
        .hero-content {
            position: relative;
            z-index: 2;
        }
        .hero-content h1 { font-size: 2.2rem; margin: 0 20px; font-weight: bold; line-height: 1.4; }

        @media (max-width: 768px) {
            .hero { height: 300px; }
            .hero-content h1 { font-size: 1.5rem; }
        }

        /* --- コンテンツ枠 --- */
        .main-wrapper {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--white);
            padding-top: 50px; 
            padding-bottom: 60px;
        }

        /* --- 業務選択ボタン --- */
        .main-actions {
            margin-top: 0;
            padding: 0 20px;
        }
        .action-grid {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .action-box {
            flex: 1;
            min-width: 280px;
            padding: 30px 20px;
            border-radius: 8px;
            text-align: center;
            color: var(--white);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transition: transform 0.2s;
        }
        .action-box:hover { transform: translateY(-3px); }
        .box-survey { background-color: var(--survey-color); }
        .box-admin { background-color: var(--admin-color); }
        
        .box-title { display: block; font-size: 1.4rem; font-weight: bold; margin-bottom: 15px; }
        .phone-area {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        .phone-number { font-size: 1.4rem; font-weight: bold; }

        /* --- お問い合わせフォーム --- */
        .contact-section {
            padding: 60px 20px;
        }
        .section-title {
            text-align: center;
            color: var(--primary-color);
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        .contact-form {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--bg-form);
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: bold; margin-bottom: 5px; color: var(--primary-color); }
        
        .required { background: #d9534f; color: white; padding: 2px 5px; font-size: 0.7rem; border-radius: 3px; margin-left: 5px; }
        .optional { background: #999; color: white; padding: 2px 5px; font-size: 0.7rem; border-radius: 3px; margin-left: 5px; }
        
        /* 入力欄スタイル */
        .form-input, .form-textarea, .form-select {
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1rem;
        }
        .form-textarea { height: 120px; }
        
        /* 送信ボタン */
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            width: 100%;
            max-width: 300px;
        }
        .submit-btn:hover { opacity: 0.9; }

        /* --- コラム記事 --- */
        .column-section {
            padding: 40px 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        .column-article {
            margin-bottom: 40px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        .column-title {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .column-text {
            font-size: 0.95rem;
            line-height: 1.8;
            color: #444;
        }
        
        /* 農地転用テーブル */
        .nou-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        .nou-table th, .nou-table td {
            border: 1px solid #ccc;
            padding: 10px;
        }
        .nou-table th {
            background-color: #f0f0f0;
            text-align: center;
            width: 20%;
        }

        /* --- お役立ちツール共通 --- */
        .tool-section {
            padding: 40px 20px;
            max-width: 800px;
            margin: 0 auto 40px;
            background-color: #f5f8fc;
            border-radius: 8px;
            border: 1px solid #dce4ec;
        }
        .tool-box {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        .tool-header {
            text-align: center;
            margin-bottom: 15px;
            font-weight: bold;
            color: var(--primary-color);
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
        }
        .tool-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap; /* スマホ対応 */
        }
        .tool-btn {
            background-color: var(--admin-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            white-space: nowrap;
        }
        .tool-btn:hover { opacity: 0.9; }
        .active-btn { background-color: #0f2350 !important; }
        .inactive-btn { background-color: #6c757d !important; opacity: 0.8; }
        
        /* 結果表示エリア */
        .tool-result {
            background-color: #0f2350;
            color: white;
            padding: 20px;
            border-radius: 5px;
        }
        .tool-result-item {
            margin-bottom: 10px;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 5px;
            display: flex;
            align-items: center;
        }
        .tool-result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .tool-label {
            font-size: 0.8rem;
            opacity: 0.8;
            display: block;
            min-width: 100px;
        }
        .zodiac-icon {
            width: 28px;
            height: 28px;
            margin-left: 10px;
            fill: #fff;
            vertical-align: middle;
        }

        /* --- 相続図作成ツール用スタイル --- */
        .family-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        .family-input-row input, .family-input-row select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            min-width: 0;
        }
        .btn-add { background-color: #28a745; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
        .btn-del { background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
        
        #canvasContainer {
            text-align: center;
            overflow-x: auto;
            margin-top: 20px;
            border: 1px solid #ddd;
            background: #fff;
        }
        canvas {
            max-width: 100%;
            height: auto;
        }

        /* --- 位置図マップ用 --- */
        .map-result-container {
            position: relative;
            padding-bottom: 75%;
            height: 0;
            overflow: hidden;
            background: #eee;
            margin-top: 15px;
            border: 1px solid #ccc;
        }
        .map-result-container iframe, .map-result-container .leaflet-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        
        /* ファイルドロップエリア */
        .file-upload-area {
            border: 3px dashed #ccc;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            background: #fafafa;
            margin-bottom: 15px;
            cursor: pointer;
            transition: 0.3s;
        }
        .file-upload-area:hover { background: #eef4fb; border-color: var(--admin-color); }

        /* ▼▼▼ 印刷用スタイル（地図をA4縦にフィット） ▼▼▼ */
        #printHeader { display: none; }

        @media print {
            @page { 
                size: A4 portrait; 
                margin: 5mm; /* マージンを最小限に */
            }
            body { 
                background: white !important;
                height: 100vh;
                margin: 0 !important;
                padding: 0 !important;
            }
            /* 全要素を非表示 */
            body > * { display: none !important; }
            
            /* 印刷対象のラッパーを表示 */
            .main-wrapper { 
                display: block !important; 
                padding: 0 !important; 
                margin: 0 !important;
                width: 100% !important;
                height: 100% !important;
            }
            
            /* 不要パーツを非表示 */
            header, footer, .hero, .main-actions, .contact-section, .column-section, .office-info,
            .tool-section > h2, .tool-section > p, 
            .tool-box > *:not(.map-result-container):not(#printHeader),
            .file-upload-area, #simaStatus, .tool-input-group {
                display: none !important;
            }

            /* ツールボックスの枠線を消す */
            .tool-section, .tool-box {
                border: none !important;
                box-shadow: none !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
                height: 100% !important;
            }

            /* 印刷ヘッダー */
            #printHeader {
                display: block !important;
                width: 100%;
                margin-bottom: 5mm;
                border-bottom: 2px solid #000;
                padding-bottom: 2mm;
            }
            #printHeader h1 { font-size: 24pt; margin: 0; }
            #printHeader p { font-size: 16pt; margin: 2mm 0 0 0; }

            /* 地図エリアを最大化 */
            .map-result-container {
                display: block !important;
                position: static !important;
                /* A4縦(297mm) - マージン(10mm) - ヘッダー(約25mm) = 約260mm */
                height: 260mm !important; 
                width: 100% !important;
                padding-bottom: 0 !important;
                border: 2px solid #000 !important;
                box-sizing: border-box !important;
                overflow: hidden !important;
            }
            
            /* プロット（●）を印刷時のみ消す */
            .sima-marker {
                display: none !important;
            }
        }

        @media (max-width: 600px) {
            .family-input-row { gap: 5px; }
            .heir-rel { flex-basis: 35%; }
            .heir-name, #decedentName, #decedentDate { flex: 1; }
            .heir-addr, #decedentAddress { flex-basis: 100% !important; margin-top: 5px; width: 100%; }
            .btn-del { margin-left: auto; }
        }

        /* --- 事務所情報 --- */
        .office-info {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            background: #f9f9f9;
        }
        .map-container {
            width: 100%;
            height: 350px;
            margin-top: 20px;
            background: #eee;
        }
        
        /* --- フッター --- */
        footer {
            background-color: var(--primary-color);
            color: #aaa;
            text-align: center;
            padding: 20px 0;
            font-size: 0.8rem;
            max-width: 1000px;
            margin: 0 auto;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">植村 土地家屋調査士・行政書士事務所</div>
</header>

<section class="hero">
    <div class="hero-content">
        <h1>家づくり・土地活用。<br>「測量」と「許認可」をワンストップで。</h1>
    </div>
</section>

<div class="main-wrapper">
    <div class="main-actions">
        <div class="action-grid">
            <div class="action-box box-survey">
                <a href="business-guide.png" target="_blank" style="text-decoration:none; color:white;">
                    <span class="box-title" style="text-decoration:underline; text-underline-offset: 4px;">
                        土地家屋調査士業務 <i class="fa-regular fa-image" style="font-size:0.8em; margin-left:5px;"></i>
                    </span>
                </a>
                <a href="tel:08072319467">
                    <div class="phone-area">
                        <i class="fa-solid fa-mobile-screen"></i>
                        <span class="phone-number">080-7231-9467</span>
                    </div>
                </a>
            </div>
            <div class="action-box box-admin">
                <a href="admin-guide.png" target="_blank" style="text-decoration:none; color:white;">
                    <span class="box-title" style="text-decoration:underline; text-underline-offset: 4px;">
                        行政書士業務 <i class="fa-regular fa-image" style="font-size:0.8em; margin-left:5px;"></i>
                    </span>
                </a>
                <a href="tel:07066256247">
                    <div class="phone-area">
                        <i class="fa-solid fa-mobile-screen"></i>
                        <span class="phone-number">070-6625-6247</span>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="contact-section">
        <h2 class="section-title">お問い合わせ・ご相談</h2>
        <p style="text-align: center; margin-bottom: 20px;">
            以下のフォームにご記入の上、送信ボタンを押してください。
        </p>

        <form action="https://formspree.io/f/mdkqdjlz" method="POST" class="contact-form" autocomplete="off">
            <div class="form-group">
                <label class="form-label">お名前 <span class="required">必須</span></label>
                <input type="text" name="お名前" class="form-input" placeholder="例：植村 太郎" required>
            </div>
            <div class="form-group">
                <label class="form-label">メールアドレス <span class="required">必須</span></label>
                <input type="email" name="email" class="form-input" placeholder="info@example.com" required>
            </div>
            <div class="form-group">
                <label class="form-label">お電話番号 <span class="optional">任意</span></label>
                <input type="tel" name="電話番号" class="form-input" placeholder="090-0000-0000">
            </div>
            <div class="form-group">
                <label class="form-label">ご相談内容 <span class="required">必須</span></label>
                <textarea name="詳細" class="form-textarea" placeholder="ご相談内容をご記入ください。" required></textarea>
            </div>
            <button type="submit" class="submit-btn">送信する</button>
        </form>
    </div>

    <div class="column-section">
        <h2 class="section-title">お役立ち情報（農地転用・相続・測量など）</h2>
        <article class="column-article">
            <h3 class="column-title" style="color:#d9534f;">
                <i class="fa-solid fa-triangle-exclamation"></i> 【重要】相続登記が義務化されました
            </h3>
            <p class="column-text">
                2024年4月1日から、不動産の<strong>相続登記が義務化</strong>されました。相続を知った日から3年以内に登記申請を行わない場合、最大10万円の過料が科される可能性があります。<br>
                これは「過去に相続して名義変更していない土地」も対象です。当事務所では、相続人調査や遺産分割協議書の作成（行政書士）から、未登記建物の表題登記や分筆（調査士）まで、相続不動産の問題をトータルで解決します。
            </p>
        </article>
        <article class="column-article">
            <h3 class="column-title"><i class="fa-solid fa-book-open"></i> 農地転用許可・届出（3条・4条・5条）について</h3>
            <p class="column-text">
                花巻市で農地（田んぼや畑）に家を建てたり、駐車場にするには、農業委員会への<strong>「農地転用許可」</strong>が必要です。無許可で転用すると、工事の中止や原状回復命令が出される場合があります。<br>
                当事務所は、農地転用の手続きから、転用後の「地目変更登記」までを一貫してサポートできます。
            </p>
            <table class="nou-table">
                <tr><th>種類</th><th>内容</th><th>主なケース</th></tr>
                <tr><td><strong>3条許可</strong></td><td>権利移動</td><td>農地を農地のまま売買・貸借する場合</td></tr>
                <tr><td><strong>4条許可</strong></td><td>転用</td><td>自分の農地を宅地や駐車場にする場合</td></tr>
                <tr><td><strong>5条許可</strong></td><td>転用＋権利移動</td><td>農地を買って（借りて）宅地にする場合</td></tr>
            </table>
        </article>
        <article class="column-article">
            <h3 class="column-title"><i class="fa-solid fa-map-location-dot"></i> 境界確定測量と境界トラブル</h3>
            <p class="column-text">
                土地を売却したり、ブロック塀を設置する際、「境界杭が見当たらない」ことは大きなトラブルの原因になります。<br>
                正しい境界を確定させるためには、土地家屋調査士による<strong>「境界確定測量」</strong>が必要です。
            </p>
        </article>
    </div>

    <div class="tool-section">
        <h2 class="section-title">【便利ツール】現場位置図検索</h2>
        <p style="text-align:center; font-size:0.9rem; margin-bottom:20px;">
            地番検索、またはSIMAファイル(座標データ)から地図を表示します。<br>
            <small style="color:#d9534f;">※地番検索は正確な位置が出ない場合があります。SIMA読込は世界測地系(第10系)に対応。</small>
        </p>
        
        <div class="tool-box" id="mapToolBox">
            <div style="display:flex; justify-content:center; gap:10px; margin-bottom:15px;">
                <button type="button" class="tool-btn active-btn" id="tabChiban" onclick="switchMapMode('chiban')">地番から検索</button>
                <button type="button" class="tool-btn inactive-btn" id="tabSima" onclick="switchMapMode('sima')">SIMAから特定</button>
            </div>

            <div id="modeChiban">
                <div class="tool-input-group">
                    <input type="text" id="mapCity" class="form-input" placeholder="市町村 (例: 花巻市)" value="" style="flex:1;">
                    <input type="text" id="mapTown" class="form-input" placeholder="町名・大字 (例: 花城町)" style="flex:1;">
                    <input type="text" id="mapLot" class="form-input" placeholder="地番 (例: 12-6)" style="flex:1;">
                </div>
                <div style="text-align:center; margin-bottom:10px;">
                    <button type="button" id="showMapBtn" class="tool-btn">地図を表示</button>
                </div>
            </div>

            <div id="modeSima" style="display:none;">
                <div class="file-upload-area" id="dropArea" onclick="document.getElementById('simaFile').click()">
                    <i class="fa-solid fa-file-arrow-up" style="font-size:2rem; color:#aaa; margin-bottom:10px;"></i><br>
                    <span style="font-size:0.95rem; font-weight:bold; color:#0f2350;">ここにSIMAファイルをドロップ</span><br>
                    <span style="font-size:0.85rem; color:#666;">またはクリックしてファイルを選択</span>
                    <input type="file" id="simaFile" accept=".sim,.sima,.txt" style="display:none;">
                </div>
                <div id="simaStatus" style="text-align:center; font-size:0.9rem; color:#0f2350; font-weight:bold; margin-bottom:10px;"></div>
            </div>
            
            <div id="printHeader">
                <h1>位置図</h1>
                <p>所在：<span id="printLocation"></span></p>
            </div>

            <div class="map-result-container" id="mapContainer">
                <iframe id="mapFrame" src="" frameborder="0" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                <div id="simaLeafletMap" style="width:100%; height:100%; display:none;"></div>
            </div>
            
            <div style="text-align:center; margin-top:15px;">
                <button type="button" id="printMapBtn" class="tool-btn" style="background-color:#c5a059; display:none;">
                    <i class="fa-solid fa-print"></i> 位置図作成 (PDF保存・印刷)
                </button>
            </div>
        </div>
    </div>

    <div class="tool-section">
        <h2 class="section-title">【便利ツール】坪 ⇔ 平米(㎡) ⇔ 畳 換算</h2>
        <div class="tool-box">
            <div class="family-input-row">
                <span class="tool-label" style="min-width:60px;">坪数</span>
                <input type="number" id="tsuboInput" class="form-input" placeholder="坪" style="flex:1;">
            </div>
            <div class="family-input-row">
                <span class="tool-label" style="min-width:60px;">平米</span>
                <input type="number" id="m2Input" class="form-input" placeholder="㎡" style="flex:1;">
            </div>
            <div class="family-input-row">
                <span class="tool-label" style="min-width:60px;">畳数</span>
                <input type="number" id="joInput" class="form-input" placeholder="畳 (中京間)" style="flex:1;">
            </div>
            <p style="font-size:0.8rem; color:#666; text-align:right; margin-top:5px;">※1坪 = 3.30578㎡、1畳 = 1.6562㎡</p>
        </div>
    </div>

    <div class="tool-section" style="margin-top:-20px;">
        <h2 class="section-title">【便利ツール】登録免許税 (概算) 計算</h2>
        <div class="tool-box">
            <div class="family-input-row">
                <span class="tool-label" style="min-width:80px;">評価額</span>
                <input type="number" id="taxValue" class="form-input" placeholder="円 (例: 10000000)" style="flex:1;">
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; justify-content:center;">
                <button type="button" class="tool-btn" onclick="calcTax(0.004, '所有権保存 (新築等)')">保存 (0.4%)</button>
                <button type="button" class="tool-btn" onclick="calcTax(0.02, '所有権移転 (売買等)')">移転 (2.0%)</button>
                <button type="button" class="tool-btn" onclick="calcTax(0.004, '抵当権設定 (債権額)')">抵当権 (0.4%)</button>
            </div>
            <div id="taxResult" style="background:#f9f9f9; padding:15px; border-radius:4px; border:1px solid #ddd; margin-top:15px; text-align:center;">
                <span style="font-size:0.9rem;">ここに計算結果が表示されます</span>
            </div>
        </div>
    </div>

    <div class="tool-section">
        <h2 class="section-title">【無料ツール】相続関係説明図メーカー</h2>
        <div class="tool-box">
            <div class="tool-header">被相続人（亡くなられた方）</div>
            <div class="family-input-row">
                <input type="text" id="decedentName" placeholder="氏名 (例: 植村 一郎)" style="flex:2;">
                <input type="text" id="decedentDate" placeholder="死亡日 (例: 令和5年1月1日)" style="flex:2;">
            </div>
            <div class="family-input-row">
                <input type="text" id="decedentAddress" placeholder="最後の住所 (例: 花巻市花城町12-6)" style="flex:4;">
            </div>

            <div class="tool-header" style="margin-top:20px;">相続人（配偶者・子）</div>
            <div id="heirsContainer">
                <div class="family-input-row">
                    <select class="heir-rel" style="width:90px;" disabled>
                        <option value="配偶者" selected>配偶者</option>
                    </select>
                    <input type="text" class="heir-name" placeholder="氏名 (例: 植村 花子)" style="flex:1;">
                    <input type="text" class="heir-addr" placeholder="住所" style="flex:2;">
                </div>
                <div class="family-input-row">
                    <select class="heir-rel" style="width:90px;">
                        <option value="長男">長男</option>
                        <option value="二男">二男</option>
                        <option value="三男">三男</option>
                        <option value="長女">長女</option>
                        <option value="二女">二女</option>
                        <option value="三女">三女</option>
                        <option value="養子">養子</option>
                        <option value="子">子</option>
                    </select>
                    <input type="text" class="heir-name" placeholder="氏名 (例: 植村 次郎)" style="flex:1;">
                    <input type="text" class="heir-addr" placeholder="住所" style="flex:2;">
                </div>
            </div>
            
            <div style="text-align:right; margin-bottom:20px;">
                <button type="button" class="btn-add" id="addHeirBtn"><i class="fa-solid fa-plus"></i> 相続人を追加</button>
            </div>

            <div style="text-align:center; gap:10px; display:flex; justify-content:center;">
                <button type="button" class="tool-btn" id="genMapBtn">図を作成する</button>
                <button type="button" class="tool-btn" id="downloadMapBtn" style="background-color:#c5a059; display:none;">画像を保存</button>
            </div>
        </div>

        <div id="canvasContainer" style="display:none;">
            <canvas id="familyCanvas" width="800" height="600"></canvas>
            <p style="font-size:0.8rem; color:#666; margin-top:5px;">※スマートフォンの方は画像を長押しして保存してください</p>
        </div>
    </div>

    <div class="tool-section">
        <h2 class="section-title">【便利ツール】西暦・和暦・年齢・干支 変換</h2>
        <div class="tool-box">
            <div class="tool-input-group">
                <select id="eraSelect" class="form-select" style="flex:1;">
                    <option value="AD">西暦</option>
                    <option value="Reiwa">令和</option>
                    <option value="Heisei">平成</option>
                    <option value="Showa">昭和</option>
                    <option value="Taisho">大正</option>
                    <option value="Meiji">明治</option>
                </select>
                <input type="number" id="yearInput" class="form-input" placeholder="年を入力" style="flex:2;">
            </div>
            <div class="tool-result">
                <div class="tool-result-item"><span class="tool-label">西暦</span><span id="resAD">---年</span></div>
                <div class="tool-result-item"><span class="tool-label">和暦</span><span id="resEra">---</span></div>
                <div class="tool-result-item"><span class="tool-label">年齢</span><span id="resAge">---歳</span></div>
                <div class="tool-result-item"><span class="tool-label">干支</span><span id="resZodiac" style="display: flex; align-items: center;">---</span></div>
            </div>
        </div>
    </div>

    <div class="tool-section" style="margin-top:-20px;">
        <h2 class="section-title">【便利ツール】郵便番号 ↔ 住所 検索</h2>
        <div class="tool-box">
            <div class="tool-header">郵便番号 <i class="fa-solid fa-arrow-right"></i> 住所</div>
            <div class="tool-input-group">
                <input type="text" id="zipInput" class="form-input" placeholder="例: 0250075" style="flex:2;">
                <button type="button" id="zipSearchBtn" class="tool-btn">住所検索</button>
            </div>
            <div id="zipResult" style="padding:10px;"></div>
        </div>
        <div class="tool-box">
            <div class="tool-header">住所 <i class="fa-solid fa-arrow-right"></i> 郵便番号</div>
            <p style="font-size:0.9rem; margin-bottom:10px;">住所を入力してボタンを押すと、Google検索で郵便番号を表示します。</p>
            <div class="tool-input-group">
                <input type="text" id="addrInput" class="form-input" placeholder="例: 花巻市花城町" style="flex:2;">
                <button type="button" id="addrSearchBtn" class="tool-btn" style="background-color:#4285F4;">Googleで検索</button>
            </div>
        </div>
    </div>
    
    <script>
        // --- 登録免許税計算 ---
        function calcTax(rate, typeName) {
            const valStr = document.getElementById('taxValue').value;
            const val = parseInt(valStr);
            const resBox = document.getElementById('taxResult');
            if (!val || val <= 0) {
                resBox.innerHTML = '<span style="color:red;">評価額を正しく入力してください</span>';
                return;
            }
            const baseAmount = Math.floor(val / 1000) * 1000;
            let tax = Math.floor(baseAmount * rate);
            tax = Math.floor(tax / 100) * 100;
            if (tax < 1000) tax = 1000;
            resBox.innerHTML = `
                <div style="font-weight:bold; color:#0f2350; margin-bottom:5px;">${typeName}</div>
                <div style="font-size:1.4rem; color:#c5a059;">約 ${tax.toLocaleString()} 円</div>
                <div style="font-size:0.8rem; color:#666; margin-top:5px;">(課税標準: ${baseAmount.toLocaleString()}円 × ${rate*100}%)</div>
            `;
        }

        // --- マップモード切替 ---
        function switchMapMode(mode) {
            document.getElementById('modeChiban').style.display = (mode === 'chiban') ? 'block' : 'none';
            document.getElementById('modeSima').style.display = (mode === 'sima') ? 'block' : 'none';
            
            // SIMAモード切り替え時にLeafletのサイズを再計算
            if(mode === 'sima' && window.leafletMap) {
                setTimeout(() => { window.leafletMap.invalidateSize(); }, 100);
            }

            const btnChiban = document.getElementById('tabChiban');
            const btnSima = document.getElementById('tabSima');
            
            if(mode === 'chiban') {
                btnChiban.classList.add('active-btn');
                btnChiban.classList.remove('inactive-btn');
                btnSima.classList.add('inactive-btn');
                btnSima.classList.remove('active-btn');
            } else {
                btnSima.classList.add('active-btn');
                btnSima.classList.remove('inactive-btn');
                btnChiban.classList.add('inactive-btn');
                btnChiban.classList.remove('active-btn');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            let leafletMap = null; 
            let simaLayerGroup = null; 
            let currentMode = "chiban"; 
            let currentQueryOrCoord = ""; // 印刷用ラベル

            const showMapBtn = document.getElementById('showMapBtn');
            const printMapBtn = document.getElementById('printMapBtn');
            const mapFrame = document.getElementById('mapFrame');
            const printLocation = document.getElementById('printLocation');

            // A. 地番検索 (Google Maps)
            if (showMapBtn) {
                showMapBtn.addEventListener('click', function() {
                    const city = document.getElementById('mapCity').value;
                    const town = document.getElementById('mapTown').value;
                    const lot = document.getElementById('mapLot').value;
                    if (!city || !town) { alert("市町村と町名を入力してください"); return; }
                    const query = `${city} ${town} ${lot}`;
                    currentQueryOrCoord = query;
                    const embedUrl = `https://maps.google.co.jp/maps?q=${encodeURIComponent(query)}&output=embed&t=m&z=17`; 
                    mapFrame.src = embedUrl;
                    printMapBtn.style.display = 'inline-block';
                });
            }

            // B. SIMAファイル読込
            const simaFile = document.getElementById('simaFile');
            const simaStatus = document.getElementById('simaStatus');
            const dropArea = document.getElementById('dropArea');

            function initLeaflet() {
                if(leafletMap) return;
                const gsiTile = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', { attribution: "地理院タイル" });
                const gsiPhoto = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/ort/{z}/{x}/{y}.jpg', { attribution: "地理院タイル" });
                leafletMap = L.map('simaLeafletMap', { center: [39.3905, 141.1186], zoom: 15, layers: [gsiTile] });
                const baseMaps = { "標準地図": gsiTile, "航空写真": gsiPhoto };
                L.control.layers(baseMaps).addTo(leafletMap);
                simaLayerGroup = L.layerGroup().addTo(leafletMap);
                window.leafletMap = leafletMap; 
            }

            if (simaFile && dropArea) {
                if(typeof proj4 !== 'undefined') {
                    // 第10系
                    proj4.defs("EPSG:6678", "+proj=tmerc +lat_0=40 +lon_0=140.8333333333333 +k=0.9999 +x_0=0 +y_0=0 +ellps=GRS80 +units=m +no_defs");
                }

                dropArea.addEventListener('dragover', function(e) { e.preventDefault(); this.style.background = '#eef4fb'; }, false);
                dropArea.addEventListener('dragleave', function(e) { e.preventDefault(); this.style.background = '#fafafa'; }, false);
                dropArea.addEventListener('drop', function(e) { 
                    e.preventDefault(); 
                    this.style.background = '#fafafa';
                    if(e.dataTransfer.files.length > 0) { 
                        simaFile.files = e.dataTransfer.files; 
                        readSima(e.dataTransfer.files[0]); 
                    }
                }, false);

                simaFile.addEventListener('change', function(e) {
                    if(e.target.files[0]) readSima(e.target.files[0]);
                });

                function readSima(file) {
                    currentMode = "sima";
                    simaStatus.textContent = "読み込み中...";
                    initLeaflet();
                    const reader = new FileReader();
                    reader.onload = function(evt) {
                        const text = evt.target.result;
                        const lines = text.split(/\r\n|\n/);
                        const points = [];
                        let minX = 9e9, maxX = -9e9, minY = 9e9, maxY = -9e9;

                        // SIMA読込 (数値ペア検索)
                        lines.forEach(line => {
                            const parts = line.trim().split(/[\s,]+/);
                            for(let i=0; i<parts.length-1; i++) {
                                const v1 = parseFloat(parts[i]);
                                const v2 = parseFloat(parts[i+1]);
                                if(!isNaN(v1) && !isNaN(v2) && Math.abs(v1)>1000 && Math.abs(v2)>1000) {
                                    if(v1 < minX) minX = v1; if(v1 > maxX) maxX = v1;
                                    if(v2 < minY) minY = v2; if(v2 > maxY) maxY = v2;
                                    try {
                                        const wgs = proj4("EPSG:6678", "WGS84", [v2, v1]);
                                        points.push([wgs[1], wgs[0]]);
                                    } catch(e){}
                                    break; 
                                }
                            }
                        });

                        if(points.length === 0) {
                            simaStatus.textContent = "座標データが見つかりませんでした。";
                            return;
                        }

                        simaLayerGroup.clearLayers();
                        
                        // ポリゴン描画 (薄い赤: #FF6666)
                        const poly = L.polygon(points, {color: '#FF6666', weight: 3, fillOpacity:0.2}).addTo(simaLayerGroup);
                        
                        // プロット描画 (クラス名 'sima-marker' を付与して印刷時に消せるようにする)
                        points.forEach(p => {
                            L.circleMarker(p, {
                                radius:3, 
                                color:'blue',
                                className: 'sima-marker' // 重要：印刷制御用クラス
                            }).addTo(simaLayerGroup);
                        });
                        
                        leafletMap.fitBounds(poly.getBounds());
                        simaStatus.textContent = `描画完了: ${points.length}点`;
                        currentQueryOrCoord = ""; 
                        printMapBtn.style.display = 'inline-block';
                    };
                    reader.readAsText(file, "Shift_JIS");
                }
            }

            // 印刷機能（現在画面の印刷スタイル適用）
            if (printMapBtn) {
                printMapBtn.onclick = function() {
                    printLocation.textContent = currentQueryOrCoord;
                    alert("ブラウザの印刷機能(Ctrl+P)を使って印刷してください。\n用紙サイズを「A4」、向きを「縦」に設定すると綺麗に出力されます。");
                    window.print();
                };
            }

            // --- 他ツール (省略せず記述) ---
            
            // 2. 坪平米
            const tsuboInput = document.getElementById('tsuboInput');
            const m2Input = document.getElementById('m2Input');
            const joInput = document.getElementById('joInput');
            if (tsuboInput) {
                const TSUB = 3.30578; const JO = 1.6562;
                tsuboInput.addEventListener('input', function(){
                    const v = parseFloat(this.value);
                    if(!isNaN(v)){ m2Input.value=(v*TSUB).toFixed(2); joInput.value=((v*TSUB)/JO).toFixed(2); }
                    else{ m2Input.value=''; joInput.value=''; }
                });
                m2Input.addEventListener('input', function(){
                    const v = parseFloat(this.value);
                    if(!isNaN(v)){ tsuboInput.value=(v/TSUB).toFixed(2); joInput.value=(v/JO).toFixed(2); }
                    else{ tsuboInput.value=''; joInput.value=''; }
                });
                joInput.addEventListener('input', function(){
                    const v = parseFloat(this.value);
                    if(!isNaN(v)){ m2Input.value=(v*JO).toFixed(2); tsuboInput.value=((v*JO)/TSUB).toFixed(2); }
                    else{ tsuboInput.value=''; m2Input.value=''; }
                });
            }

            // 4. 相続図
            const genMapBtn = document.getElementById('genMapBtn');
            if(genMapBtn) {
                // (前述のロジックと同様)
                const addHeirBtn = document.getElementById('addHeirBtn');
                const heirsContainer = document.getElementById('heirsContainer');
                const downloadMapBtn = document.getElementById('downloadMapBtn');
                const canvasContainer = document.getElementById('canvasContainer');
                const canvas = document.getElementById('familyCanvas');
                const ctx = canvas.getContext('2d');

                addHeirBtn.addEventListener('click', function() {
                    const div = document.createElement('div');
                    div.className = 'family-input-row';
                    div.innerHTML = `
                        <select class="heir-rel" style="width:90px;"><option value="長男">長男</option><option value="二男">二男</option><option value="三男">三男</option><option value="長女">長女</option><option value="二女">二女</option><option value="三女">三女</option><option value="養子">養子</option><option value="子">子</option></select>
                        <input type="text" class="heir-name" placeholder="氏名" style="flex:1;">
                        <input type="text" class="heir-addr" placeholder="住所" style="flex:2;">
                        <button type="button" class="btn-del" onclick="this.parentElement.remove()">×</button>
                    `;
                    heirsContainer.appendChild(div);
                });

                genMapBtn.addEventListener('click', function() {
                    // (描画ロジック：前回の完全版と同じ)
                    const decedent = { name: document.getElementById('decedentName').value||"被相続人", date: document.getElementById('decedentDate').value||"", addr: document.getElementById('decedentAddress').value||"" };
                    const heirRows = document.querySelectorAll('#heirsContainer .family-input-row');
                    let spouse = null; let children = [];
                    heirRows.forEach(row => {
                        const rel = row.querySelector('.heir-rel').value;
                        const name = row.querySelector('.heir-name').value;
                        const addr = row.querySelector('.heir-addr').value;
                        if(name) { if(rel==='配偶者') spouse={name,addr,rel}; else children.push({name,addr,rel}); }
                    });
                    
                    canvasContainer.style.display='block'; downloadMapBtn.style.display='inline-block';
                    ctx.fillStyle="#fff"; ctx.fillRect(0,0,800,600);
                    ctx.strokeStyle="#000"; ctx.lineWidth=2; ctx.font="16px sans-serif"; ctx.textAlign="left"; ctx.textBaseline="middle";
                    ctx.fillStyle="#000"; ctx.font="bold 20px sans-serif"; ctx.fillText("相続関係説明図",30,40);
                    
                    const boxW=160, boxH=80, gapX=40, startY=100, centerX=400;
                    let decX = spouse ? centerX-(boxW/2)-30 : centerX-(boxW/2);
                    drawBox(decX, startY, boxW, boxH, `被相続人 ${decedent.name}`, decedent.date, decedent.addr);
                    
                    if(spouse) {
                        let spX = decX+boxW+60;
                        drawBox(spX, startY, boxW, boxH, `${spouse.rel} ${spouse.name}`, "", spouse.addr);
                        ctx.beginPath(); ctx.moveTo(decX+boxW,startY+boxH/2-3); ctx.lineTo(spX,startY+boxH/2-3); ctx.moveTo(decX+boxW,startY+boxH/2+3); ctx.lineTo(spX,startY+boxH/2+3); ctx.stroke();
                    }
                    if(children.length>0) {
                        let pCX = spouse ? decX+boxW+30 : decX+boxW/2;
                        let cY = startY+boxH+60;
                        ctx.beginPath(); ctx.moveTo(pCX,startY+boxH/2+(spouse?3:40)); ctx.lineTo(pCX,cY-20); ctx.stroke();
                        let totalW = (boxW*children.length)+(gapX*(children.length-1));
                        let sX = pCX-(totalW/2);
                        ctx.beginPath(); ctx.moveTo(sX+boxW/2,cY-20); ctx.lineTo(sX+totalW-boxW/2,cY-20); ctx.stroke();
                        children.forEach((c,i)=>{
                            let cx = sX+(boxW+gapX)*i;
                            ctx.beginPath(); ctx.moveTo(cx+boxW/2,cY-20); ctx.lineTo(cx+boxW/2,cY); ctx.stroke();
                            drawBox(cx, cY, boxW, boxH, `${c.rel} ${c.name}`, "", c.addr);
                        });
                    }
                    ctx.font="12px sans-serif"; ctx.fillStyle="#666"; ctx.fillText("作成：植村 土地家屋調査士・行政書士事務所", 550, 580);
                });
                
                function drawBox(x,y,w,h,l1,l2,l3){
                    ctx.fillStyle="#fff"; ctx.strokeStyle="#000"; ctx.lineWidth=1; ctx.fillRect(x,y,w,h); ctx.strokeRect(x,y,w,h);
                    ctx.fillStyle="#000"; ctx.font="bold 14px sans-serif"; ctx.fillText(l1,x+10,y+25);
                    ctx.font="12px sans-serif"; if(l2)ctx.fillText(l2,x+10,y+45); if(l3)ctx.fillText(l3,x+10,y+65);
                }
                downloadMapBtn.onclick=function(){const l=document.createElement('a');l.download='sozoku.png';l.href=canvas.toDataURL();l.click();};
            }

            // 5. 郵便番号
            const zipInput = document.getElementById('zipInput');
            const zipSearchBtn = document.getElementById('zipSearchBtn');
            const zipResult = document.getElementById('zipResult');
            if(zipSearchBtn) {
                zipSearchBtn.addEventListener('click', function() {
                    let zip = zipInput.value.replace(/-/g,'');
                    if(zip.length!==7){ zipResult.textContent="7桁で入力してください"; return; }
                    fetch(`https://zipcloud.ibsnet.co.jp/api/search?zipcode=${zip}`)
                    .then(r=>r.json()).then(d=>{
                        if(d.results) zipResult.innerHTML=`<strong>${d.results[0].address1}${d.results[0].address2}${d.results[0].address3}</strong>`;
                        else zipResult.textContent="該当なし";
                    });
                });
            }
            const addrInput = document.getElementById('addrInput');
            const addrSearchBtn = document.getElementById('addrSearchBtn');
            if(addrSearchBtn) {
                addrSearchBtn.addEventListener('click', function(){
                    if(addrInput.value) window.open(`https://www.google.com/search?q=${encodeURIComponent(addrInput.value)}+郵便番号`, '_blank');
                });
            }

            // 6. 年齢計算
            const eraSelect = document.getElementById('eraSelect');
            const yearInput = document.getElementById('yearInput');
            if(eraSelect) {
                const zData = ["申","酉","戌","亥","子","丑","寅","卯","辰","巳","午","未"];
                const zIcons = [
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm2-13h-4v2h4V7zm-4 4h4v2h-4v-2zm0 4h4v2h-4v-2z", // 申
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z", // 酉
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3 15h-2v-2h2v2zm0-4h-2V7h2v6z", // 戌
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2V7zm0 8h2v2h-2v-2z", // 亥
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.85-12.15l-1.2-1.2c-.2-.2-.51-.2-.71 0l-1.2 1.2c-.2.2-.2.51 0 .71l1.2 1.2c.2.2.51.2.71 0l1.2-1.2c.19-.2.19-.51-.01-.71zm3.5 3.5l-1.2-1.2c-.2-.2-.51-.2-.71 0l-1.2 1.2c-.2.2-.2.51 0 .71l1.2 1.2c.2.2.51.2.71 0l1.2-1.2c.2-.2.2-.51 0-.71zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z", // 子
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z", // 丑
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2.5-9.5l1.5 1.5 3.5-3.5 1.5 1.5-5 5-3-3 1.5-1.5z", // 寅
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11h-2v-2h-1v2H9v2h1v1h1v-1h2v1h1v-1h1v-2zm-1-6h-2v3h-1V7H9v3H8V7H6v5h1v2h1v-2h1v2h1v-2h1v2h1v-2h1V7z", // 卯
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm1-5h-2V7h2v4zm0 4h-2v-2h2v2z", // 辰
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm2.5-9.5l-1.5-1.5-3.5 3.5-1.5-1.5L6 12l5 5 3-3-1.5-1.5z", // 巳
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11h-2v-2h-1v2H9v2h1v1h1v-1h2v1h1v-1h1v-2zm-1-6h-2v3h-1V7H9v3H8V7H6v5h1v2h1v-2h1v2h1v-2h1v2h1v-2h1V7z", // 午
                    "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3 15h-2v-2h2v2zm0-4h-2V7h2v6z" // 未
                ];
                
                const calcEra = function() {
                    const v = parseInt(yearInput.value);
                    if(isNaN(v)) { document.getElementById('resAge').textContent="---歳"; return; }
                    let ad = v;
                    if(eraSelect.value==='Reiwa') ad+=2018;
                    else if(eraSelect.value==='Heisei') ad+=1988;
                    else if(eraSelect.value==='Showa') ad+=1925;
                    else if(eraSelect.value==='Taisho') ad+=1911;
                    else if(eraSelect.value==='Meiji') ad+=1867;
                    
                    const age = new Date().getFullYear() - ad;
                    document.getElementById('resAD').textContent = ad+"年";
                    document.getElementById('resAge').textContent = age+"歳";
                    const idx = ad%12;
                    document.getElementById('resZodiac').innerHTML = `${zData[idx]}<svg class="zodiac-icon" viewBox="0 0 24 24"><path d="${zIcons[idx]}"/></svg>`;
                };
                eraSelect.addEventListener('change', calcEra);
                yearInput.addEventListener('input', calcEra);
            }
        });
    </script>
</div>

<footer>
    <p>© 2024 Uemura Land and House Investigator & Administrative Scrivener Office.</p>
</footer>

</body>
</html>
